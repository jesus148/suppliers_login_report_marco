

<!-- COMPONENTE TABLA  -->


<div class="contenedor grid justify-content-center ">

<div class="col-11 md:col-11">


    <p-menubar class="" [model]="items" styleClass="menubar">


        <ng-template  pTemplate="start" class="" styleClass="menubar2">
          <div class="hidden md:flex md:mb-2 md:gap-3 md:justify-content-end ">


            <img src="assets/images/LogoMp2.png" height="38" class="mr-2">



              <p-button
                  (onClick)="activeIndex = 0 "
                  styleClass="w-6rem h-3rem text-sm"
                  (onClick)="btnRegistrarBanco = false"
                  (onClick)="btnRetenciones = false"
                  (onClick)="btnDeducciones = false"
                  [outlined]="activeIndex !== 0"
                  label="Estado Cuenta"
                   severity="success"
                 />




              <p-button
                  (onClick)="activeIndex = 2"
                  (onClick)="btnRegistrarBanco = false"
                  (onClick)="btnRetenciones = true"
                  (onClick)="btnDeducciones = false"
                  styleClass="w-7rem h-3rem text-sm "
                  [outlined]="activeIndex !== 2"
                  label="Detracciones"
                  severity="success" />

              <p-button
                  (onClick)="activeIndex = 3"
                  (onClick)="btnRegistrarBanco = false"
                  (onClick)="btnRetenciones = false"
                  (onClick)="btnDeducciones = true"
                  styleClass="w-7rem h-3rem text-sm"
                  [outlined]="activeIndex !== 3"
                  label="Retenciones"
                  severity="success" />


                  <p-button
                  (onClick)="activeIndex = 1"
                  (onClick)="btnRegistrarBanco = true"
                  (onClick)="btnRetenciones = false"
                  (onClick)="btnDeducciones = false"
                  styleClass=" w-8rem h-3rem  text-sm p-2"
                  [outlined]="activeIndex !== 1"
                  label="Cuentas de Banco"
                  severity="primary"
                  icon="pi pi-user-edit" />



          </div>

          <div class="flex mb-2 gap-3 justify-content-end  md:hidden">
            <img src="assets/images/LogoMp2.png" height="38" class="mr-2">

          </div>



        </ng-template>

  </p-menubar>


    <div class="ml-3 md:ml-2">
        <h4>Proveedor {{usuario}}</h4>
    </div>



    <!-- tabla  -->

  <div class="contenedor_2 grid justify-content-center align-content-center  h-auto">
    <div class="col-11 md:col-12  ">
      <!-- elemento flexible  es para encabezado para el header -->
      <p-card #menu2 styleClass="menu2"
  class="h-7rem" >

  <div class="flex flex-row-reverse  md:h-3rem mb-0 justify-content-between  h-4rem" style="margin-bottom: -30px;" >
    <div>

      @if(btnRegistrarBanco ){
      <p-button label="Registrar Banco" severity="primary" (onClick)="mostrarModal()" class=""/>
      }

    </div>
    <div>


        @if(btnRegistrarBanco  && !btnDeducciones && !btnRetenciones ){
          <h3 class="text-lg md:text-2xl">LISTA DE CUENTAS DE BANCO </h3>
        }@else if(!btnRegistrarBanco && btnDeducciones && !btnRetenciones  ){
          <h3 class="text-lg md:text-2xl">ESTADO DE CUENTA - DEDUCCIONES</h3>
        }@else if(!btnRegistrarBanco && !btnDeducciones && btnRetenciones  ){
          <h3 class="text-lg md:text-2xl">ESTADO DE CUENTA - DETRACCIONES</h3>
        }@else {
          <h3 class="text-lg md:text-2xl">ESTADO DE CUENTA - FACTURAS POR PAGAR</h3>
        }

    </div>
  </div>

  <div class="m-0">

        <!-- tabla  -->
            <p-tabView [(activeIndex)]="activeIndex" styleClass=""
            >

              <!-- 1 tabla  -->
                <p-tabPanel header=""  >
                  <p-table [styleClass]="'p-datatable-sm'" [tableStyle]="{ 'min-width':'50rem' }" [value]="DataSupliers"  id="myTable">
                    <ng-template pTemplate="header" class="mystyle">
                      <tr>
                          <th>Serie_Correl</th>
                          <th>Fecha Emision</th>
                          <th>Fecha Vencimiento</th>
                          <!-- <th>Fecha Programacion</th> -->
                          <th>Moneda</th>
                          <th class="text-center">Total</th>
                          <th class="text-center">Monto</th>
                          <th class="text-center">Saldo</th>
                          <!-- <th></th> -->
                      </tr>
                  </ng-template>
                                  <ng-template pTemplate="body" let-supliers>
                                <tr>
                                    <td>{{ supliers.SERIE_CORREL }}</td>
                                    <!-- lo corta el valor  -->
                                    <td>{{ supliers.Fec_Emision.split(' ')[0] }}</td>
                                    <td>{{ supliers.Fec_VCTO.split(' ')[0] }}</td>
                                    <!-- <td>{{ supliers.Fec_Programacion }}</td> -->
                                    <td>{{ supliers.Moneda }}</td>

                                    <!-- mejora el decimal con 2   -->
                                    <td class="text-right"> {{  supliers.Total_Documento | number:   '1.2-2' }}</td>
                                    <td class="text-right">{{ supliers.Monto_pagado  | number:   '1.2' }}</td>
                                    <td class="flex justify-content-end">S/.{{ supliers.Saldo_pendiente | number :  '1.2'}}</td>
                                    <!-- <td class="text-center flex gap-3" >
                                      <p-button  icon="pi pi-pencil" [text]="true" [raised]="true" />
                                      <p-button  icon="pi pi-times" [text]="true" [raised]="true" />
                                  </td> -->
                                </tr>
                            </ng-template>

                  </p-table>
                </p-tabPanel>

                <!-- 2 tabla  -->
                <p-tabPanel  header="" class="border-white" [closable]="false"  >
                  <p-table [styleClass]="'p-datatable-sm'" [value]="dataSuppliersBanck" >
                    <ng-template pTemplate="header"  >
                      <tr >
                          <th>Codigo Banco </th>
                          <th>Pais</th>
                          <th>Cuenta </th>
                          <th>Tipo Cuenta</th>
                          <th>Moneda Sap</th>
                          <th>Moneda Banco</th>

                          <th></th>
                      </tr>
                  </ng-template>
                                  <ng-template pTemplate="body" let-supliersbanck let-i="rowIndex" >
                                <tr>
                                    <td>{{ supliersbanck.Codigo_Banco }}</td>
                                    <!-- lo corta el valor  -->
                                    <td>{{ supliersbanck.Pais }}</td>
                                    <td>{{ supliersbanck.Cuenta}}</td>
                                    <!-- <td>{{ supliersbanck.Fec_Programacion }}</td> -->
                                    <td>{{ supliersbanck.Tipo_Cuenta }}</td>

                                    <!-- mejora el decimal con 2   -->
                                    <td>{{  supliersbanck.Moneda_SAP }}</td>
                                    <td>{{ supliersbanck.Moneda_Banco   }}</td>
                                    <td>
                                      <p-button icon="pi pi-pencil" [rounded]="true" (click)="modalBanco(supliersbanck , i)" />


                                    </td>


                                </tr>
                            </ng-template>

                  </p-table>
                </p-tabPanel>
                <!-- 3 tabla  -->
                <p-tabPanel  header="" class="border-white" [closable]="false"  >
                  <p-table [styleClass]="'p-datatable-sm'" [value]="paginatedData" [tableStyle]="{  }">
                    <ng-template pTemplate="header" >
                      <tr >
                          <th style="font-size: 16px;" >Sunat</th>
                          <th style="font-size: 16px;">Emisión</th>
                          <th style="font-size: 16px;">Vencimiento</th>
                          <th style="font-size: 16px;">Moneda</th>
                          <th style="font-size: 16px;">Total</th>
                          <th style="font-size: 16px;" class="">Detracción</th>
                          <!-- <th style="font-size: 16px;" class="text-center">Redondeo</th> -->
                      </tr>
                  </ng-template>
                                  <ng-template pTemplate="body" let-DeductionsBanck let-i="rowIndex" >
                                <tr>

                                  <td>{{DeductionsBanck.Sunat}}</td>
                                  <td>{{DeductionsBanck.Emision.split(' ')[0]}}</td>
                                  <td>{{DeductionsBanck.Vencimiento.split(' ')[0]}}</td>
                                  <td>{{DeductionsBanck.Moneda}}</td>
                                  <td>{{DeductionsBanck.Total | number  : '1.2-2'}}</td>
                                  <td class="flex justify-content-evenly">{{DeductionsBanck.Detraccion | number : '1.2-2'}}</td>
                                  <!-- <td class="text-right bg-green-200">{{DeductionsBanck.Redondeo
                                    | number : '1.2-3'}}</td>
                                </tr> -->
                            </ng-template>

                  </p-table>
                  <p-paginator [rows]="rows" [totalRecords]="totalRecords" (onPageChange)="Paginator($event)" styleClass="custom-paginator">
                  </p-paginator>

                </p-tabPanel>
                <!-- 4 tabla  -->
                <p-tabPanel  header="" class="border-white" [closable]="false" >
                  <p-table [styleClass]="'p-datatable-sm'" [value]="paginatedData2" [tableStyle]="{ 'min-width': '77rem','text-align':'center' }"
                  >

                    <ng-template pTemplate="header"  >
                      <tr >
                          <th style="font-size: 16px;">Serie_Correlativo</th>
                          <th style="font-size: 16px;">Fec_Emi</th>
                          <th style="font-size: 16px;">Mo_Fac</th>
                          <th style="font-size: 16px;">Total_Fact</th>
                          <th style="font-size: 16px;" class="text-center">Compret</th>
                          <th style="font-size: 16px;" class="text-center">Fecha Retención</th>
                          <th style="font-size: 16px;" class="text-center">Mo_Pag</th>
                          <th style="font-size: 16px;">Total Pago</th>
                          <th style="font-size: 16px;">Retenido</th>
                          <th style="font-size: 16px;" class="text-center">Tc</th>
                          <!-- <th style="font-size: 16px;">Tco</th> -->

                          <th></th>
                      </tr>
                  </ng-template>
                                  <ng-template pTemplate="body" let-Withholdings let-i="rowIndex" >
                                <tr>
                                    <td>{{ Withholdings.SERIE_CORRELATIVO }}</td>
                                    <!-- lo corta el valor desde espacio en blanco muestra el 1 valor -->
                                    <td>{{ Withholdings.FEC_EMI_FACT.split(' ')[0]   }}</td>
                                    <td>{{ Withholdings.MONEDA_FACT }}</td>

                                    <td>{{ Withholdings.TOTAL_FACT | number : '1.2-2'}}</td>

                                    <td>
                                      {{Withholdings.COMPRET }}

                                    </td>
                                    <td>{{  Withholdings.FECHA_RETENCION.split(' ')[0] }}</td>
                                    <td>{{ Withholdings.MONEDA_PAGO   }}</td>
                                    <td>{{ Withholdings.TOTAL_PAGO  | number : '1.2-2' }}</td>
                                    <td>
                                      {{Withholdings.RETENIDO | number: '1.2-2' }}

                                    </td>
                                    <!-- mejora el decimal    -->
                                    <td>
                                    {{Withholdings.TC| number : '' }}
                                    </td>
                                    <!-- <td>
                                      {{Withholdings.TCO }}
                                    </td> -->


                                </tr>
                            </ng-template>

                  </p-table>


                  <p-paginator [rows]="rows" [totalRecords]="totalRecords2" (onPageChange)="Paginator2($event)" styleClass="custom-paginator">
                  </p-paginator>

                </p-tabPanel>


        </p-tabView>




  </div>





      </p-card>
    </div>
  </div>


</div>

</div>










<!-- MODAL ACTUALIZAR CONTRASEÑA -->

<p-dialog header="Actualizar Contraseña" [(visible)]="modalBolean" [style]="{ width: '25rem' , height: '350px' }"  [draggable]="false" [resizable]="false"
  >

  <form [formGroup]="loginForm" (ngSubmit)="restablecer()">

    <div class="flex align-items-center gap-3 mb-3 mt-5 p-2">
        <label for="username" class="font-semibold w-6rem">Usuario</label>
        <input pInputText id="username" class="flex-auto border-1 h-2rem border-round" formControlName="usuario"
        [(ngModel)]="cardCode"  type="text" readonly   />
    </div>


    <div class="flex align-items-center gap-3 mb-5 p-2">
        <label for="email" class="font-semibold w-6rem">Contraseña</label>
        <input pInputText id="email" class="flex-auto border-1 h-2rem border-round" autocomplete="off" formControlName="password"/>
    </div>


    <div class="flex justify-content-evenly gap-2">
        <p-button label="Actualizar" type="submit" />
    </div>

  </form>
</p-dialog>









<!-- MODAL REGISTRAR BANCO  -->


<p-dialog header="Registrar Banco" [(visible)]="modalRegistrar" [style]="{ width: '28rem' , height: '550px' }"  [draggable]="false" [resizable]="false" >

  <form [formGroup]="registrarBanco" (ngSubmit)="registrarBank()">

<div class="flex align-items-center gap-2 mb-5 mt-5 p-2">
    <label for="update1" class="font-semibold w-6rem  text-center">Bancos </label>
    <div class="custom-select-container relative ">
      <select name="update1" class="custom-select border-round w-full" [(ngModel)]="bankCode" style="height: 30px;" formControlName="bancos" (change)="changeTypeCount()">
          <option value="" *ngIf="divisasBoolean">Seleccione el banco </option>
          @for (user of listaBancos; track user) {
              <option [value]="user.value">{{ user.name }} </option>
          }
      </select>
  </div>
</div>
<div class="flex align-items-center gap-3 mb-5 p-2 ">
  <label for="update2" class="font-semibold w-8rem text-center">Numero de Cuenta</label>
  <input pInputText id="username" class="flex-auto border-1  border-round"
  [(ngModel)]="accountNo"  type="text" style="width: 100%; height: 30px;"  formControlName="numCuenta" />

</div>

<div class="flex align-items-center gap-3 mb-5 p-2  ">
    <label for="update3" class="font-semibold w-8rem text-center">
      Divisas
    </label>
    <select name="update3" class="custom-select w-full border-round" [(ngModel)]="divisas" style="height: 30px;" formControlName="divisas" >
      <option value="" *ngIf="disableCuenta" >Seleccione las divisas </option>
      @for (user of currency; track user) {
          <option [value]="user.value">{{ user.name }} </option>
      }
  </select>
</div>

<div class="flex align-items-center gap-3 mb-5 p-2">
  <label for="update4" class="font-semibold w-8rem text-center">
    Tipos de Cuentas
  </label>
  <select name="update4" class="custom-select border-round" [(ngModel)]="bankAccountType" style="width: 100%; height: 30px;" formControlName="tipoCuentas">
    <option value="">Seleccione tipos de cuentas </option>
    @if(accountType2){
      @for (user of accountType2; track user) {
          <option [value]="user.value">{{ user.name }} </option>
      }
    }
    @for (user of accountType; track user) {
      <option [value]="user.value">{{ user.name }} </option>
  }

</select>
</div>

<div class="flex justify-content-evenly gap-2">
    <p-button label="Registrar" type="submit" severity="success"   />
</div>

</form>
</p-dialog>









<!-- modal actualizar banco -->
   <p-dialog header="Actualizar Bancos" [(visible)]="modalActualizar" [style]="{ width: '28rem' , height: '550px' }"  [draggable]="false" [resizable]="false" >
    <form [formGroup]="actualizarBanco" (ngSubmit)="ActualizarBank()">
    <div class="flex align-items-center  mb-5 mt-5 p-2 ">
      <label for="username" class="font-semibold w-8rem  text-center">Bancos</label>
      <div class="custom-select-container relative ">
        <select name="para" class="custom-select border-round" [(ngModel)]="bankCode2" style="width: 100%; height: 30px;" formControlName="bancos">
            <option value="">Seleccione el banco </option>
            @for (user of listaBancos; track user) {
                <option [value]="user.value">{{ user.name }} </option>
            }
        </select>
    </div>
  </div>
  <div class="flex align-items-center gap-3 mb-5 p-2 ">
    <label for="email" class="font-semibold w-8rem text-center">Numero de Cuenta</label>
    <input pInputText id="username" class="flex-auto border-1  border-round"
    [(ngModel)]="accountNo2"  type="text" style="width: 100%; height: 30px;"  formControlName="accountNo" />
  </div>
  <div class="flex align-items-center gap-3 mb-5 p-2  ">
      <label for="email" class="font-semibold w-8rem text-center">
        Divisas
      </label>
      <select name="para" class="custom-select w-full border-round" [(ngModel)]="userCurrBank2" style="width: 100%; height: 30px;" formControlName="divisas" >
        <option value="">Seleccione las divisas </option>
        @for (user of currency; track user) {
            <option [value]="user.value">{{ user.name }} </option>
        }
    </select>
  </div>
  <div class="flex align-items-center gap-3 mb-5 p-2">
    <label for="email" class="font-semibold w-8rem text-center">
      Tipos de Cuentas
    </label>
    <select name="para" class="custom-select border-round" [(ngModel)]="bankAccountType2" style="width: 100%; height: 30px;" formControlName="tipoCuentas">
      <option value="">Seleccione tipos de cuentas </option>
      @for (user of accountType; track user) {
          <option [value]="user.value">{{ user.name }} </option>
      }
  </select>
  </div>
  <div class="flex justify-content-evenly gap-2">
      <p-button label="Actualizar" type="submit" severity="success"   />
  </div>

  </form>

  </p-dialog>


































<p-toast></p-toast>
